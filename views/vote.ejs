<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vote - Ethiopian Election System</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/vote.css">
</head>
<body>
  <div class="vote-header">
    <h1><i class="fas fa-vote-yea me-3"></i>Cast Your Vote</h1>
    <p>Choose your preferred political party for the Ethiopian elections</p>
    <div class="party-count">
      <i class="fas fa-users me-2"></i><%= parties.length %> Parties Participating
    </div>
  </div>

  <form action="/vote" method="POST" id="voteForm">
    <div class="party-grid">
      <% parties.forEach((party, index) => { %>
        <div class="party-card fade-in-up">
          <input type="radio" id="party_<%= index %>" name="party" value="<%= party.displayName %>" class="party-radio" required>
          <label for="party_<%= index %>" class="party-content">
            <div class="party-logo-container">
              <img src="<%= party.logo_url || 'https://via.placeholder.com/300x200?text=No+Logo' %>"
                   alt="<%= party.name_english %> Logo" class="party-logo">
            </div>
            <div class="party-info">
              <div class="party-name">
                <span class="party-name-english"><%= party.name_english %></span>
                <span class="party-name-amharic"><%= party.name_amharic %></span>
              </div>

              <% if (party.leader_image_url || party.leader_name_english) { %>
                <div class="party-leader">
                  <% if (party.leader_image_url) { %>
                    <img src="<%= party.leader_image_url %>"
                         alt="<%= party.leader_name_english %>"
                         class="leader-image">
                  <% } %>
                  <% if (party.leader_name_english) { %>
                    <div class="leader-name"><%= party.leader_name_english %></div>
                    <% if (party.leader_name_amharic) { %>
                      <div class="leader-name-amharic"><%= party.leader_name_amharic %></div>
                    <% } %>
                  <% } %>
                </div>
              <% } %>

              <% if (party.description_english) { %>
                <div class="party-description">
                  <%= party.description_english.length > 100 ? party.description_english.substring(0, 100) + '...' : party.description_english %>
                </div>
              <% } %>
            </div>
          </label>
        </div>
      <% }); %>
    </div>

    <div class="vote-button-container">
      <button type="submit" class="vote-button" id="submitVote">
        <i class="fas fa-check-circle me-2"></i>Submit My Vote
      </button>
    </div>
  </form>

  <div class="navigation-links">
    <a href="/" class="nav-link">
      <i class="fas fa-home me-2"></i>Back to Home
    </a>
    <a href="/party.html" class="nav-link">
      <i class="fas fa-info-circle me-2"></i>About Parties
    </a>
    <% if (isOriginalSuperAdmin) { %>
      <a href="/admin/parties" class="nav-link">
        <i class="fas fa-cog me-2"></i>Manage Parties
      </a>
    <% } %>
    <a href="/results" class="nav-link">
      <i class="fas fa-chart-bar me-2"></i>View Results
    </a>
  </div>

  <script>
    // Add visual feedback when party is selected
    document.querySelectorAll('.party-radio').forEach(radio => {
      radio.addEventListener('change', function() {
        // Remove selected class from all cards
        document.querySelectorAll('.party-card').forEach(card => {
          card.classList.remove('selected');
        });
        // Add selected class to the clicked card
        if (this.checked) {
          this.closest('.party-card').classList.add('selected');
        }
      });
    });

    // Form validation
    document.getElementById('voteForm').addEventListener('submit', function(e) {
      const selectedParty = document.querySelector('input[name="party"]:checked');
      if (!selectedParty) {
        e.preventDefault();
        alert('Please select a party before submitting your vote.');
        return false;
      }

      // Disable button to prevent double submission
      const submitButton = document.getElementById('submitVote');
      submitButton.disabled = true;
      submitButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Submitting...';
    });
  </script>
</body>
</html>
